<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat - Chef Scintilla</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <link rel="stylesheet" href="chat.css">
    <link rel="stylesheet" href="../../main.css" />
    <style>
        /* Pulsante chat fixed in basso a destra */
        #chat-open-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
        }
    </style>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const form = document.getElementById('chat-container');
            const textarea = document.querySelector('textarea');
            const chatContent = document.getElementById('chat-content');

            form.addEventListener('submit', function (e) {
                e.preventDefault();

                const message = textarea.value.trim();
                if (message === '') return;

                // Crea nuovo messaggio utente
                const messageDiv = document.createElement('div');
                messageDiv.className = 'user d-flex justify-content-end w-100 pe-3';
                messageDiv.innerHTML = `<p class="mw-75 py-2 px-3 my-2">${message}</p>`;

                // Aggiungi al chat content
                chatContent.appendChild(messageDiv);

                // Pulisci textarea
                textarea.value = '';

                // Scroll automatico in basso
                chatContent.scrollTop = chatContent.scrollHeight;
            });

            // Invia con Enter (Shift+Enter per nuova riga)
            textarea.addEventListener('keydown', function (e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    form.dispatchEvent(new Event('submit'));
                }
            });
        });
    </script>
</head>

<body>
    <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal"
        id="chat-open-button">
    </button>

    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <form id="chat-container" class="d-flex flex-column">
                    <form id="chat-container" class="d-flex flex-column">
                        <div id="chat-title" class="d-flex align-items-center p-3 gap-2">
                            <button data-bs-dismiss="modal">&#128473;</button>
                            <img class="object-fit-cover"
                                src="https://nintendon.it/wp-content/uploads/2020/04/Gabibbo-NintendOn.jpg"
                                alt="profile picture">
                            <div class="ms-3">
                                <h1>Chef Scintilla</h1>
                                <h2>disponibile</h2>
                            </div>
                        </div>

                        <div id="chat-content" class="d-flex py-4">
                            <div class="user d-flex justify-content-end w-100 pe-3">
                                <p class="py-2 px-3 my-2  ">Vorrei una ricetta per la cena</p>
                            </div>
                            <div class="other d-flex w-100 ps-3">
                                <p class="py-2 px-3 my-2">Eccotela</p>
                            </div>

                        </div>

                        <div id="message-box" class=" container py-2">
                            <div class="row mx-auto p-2">
                                <label for="message-text-area" hidden>Scrivi un messaggio</label>
                                <textarea id="message-text-area" placeholder="Scrivi un messaggio..." class="col-10 "
                                    rows="1"></textarea>

                                <label for="message-send-button" hidden>Invia il messaggio</label>
                                <input id="message-send-button" type="submit" value="Invia" class="col-2" />
                            </div>
                        </div>

                    </form>
                </form>
            </div>
        </div>
    </div>

</body>

</html>